## Comparison of Net Primary Production (NPP) Models with In Situ Observations at four Data-Rich, Time-Series Locations

![npp_annual](https://github.com/user-attachments/assets/a2e31208-f995-4ae3-bbf6-4c702b44083f)

This repository contains a collection of MATLAB scripts developed to evaluate and compare net primary production (NPP) models against *in situ* data. The scripts process, format and visualise freely-available NPP model-derived products for the global ocean and compare them with *in situ* oceanographic data from four time-series locations using the <sup>14</sup>C technique, enabling the identification of the most optimal NPP model based on this comparison. The workflow addresses the often-overlooked task of systematically assessing multiple existing datasets used for forcing/calibrating/validating ocean biogeochemical models.

The analysed NPP datasets include: 
- Vertically Generalized Production Model ([**VGPM**](http://orca.science.oregonstate.edu/1080.by.2160.monthly.hdf.vgpm.m.chl.m.sst.php)).
- Carbon-based Production Model ([**CbPM**](http://orca.science.oregonstate.edu/1080.by.2160.monthly.hdf.cbpm2.m.php)).
- Carbon, Absorption, and Fluorescence Euphotic-resolving ([**CAFE**](http://orca.science.oregonstate.edu/1080.by.2160.monthly.hdf.cafe.m.php)) model.
- ESA Biological Pump and Carbon Exchange Processes ([**BICEP**](https://catalogue.ceda.ac.uk/uuid/69b2c9c6c4714517ba10dab3515e4ee6/)) project model.
- Carr ([**2002**](https://doi.org/10.1016/S0967-0645(01)00094-7)) model.

## Requirements

To use the content of this repository, ensure you have the following.
- [MATLAB](https://mathworks.com/products/matlab.html) version R2021a or later installed.
- Third-party functions downloaded from [MATLAB'S File Exchange](https://mathworks.com/matlabcentral/fileexchange/): `brewermap` and `subaxis`. Once downloaded, please place the functions under the `./resources/external/` directory.

## Repository Structure

 - `./code/`: contains the MATLAB scripts for analysing and visualising data (*provided, see "MATLAB Scripts" section*).
 - `./data/`
    - `./raw/`: raw NPP data, comprising models and *in situ* observations (*partly provided, see "Obtaining Raw Data" section*).
    - `./processed/`: output data generated by the MATLAB scripts (*partly provided, unless size limits restrictions*).
- `./resources/`
    - `./external/`: third-party resources for plotting and functions (*see "Requirements" section*).
    - `./internal/`: custom MATLAB functions generated specifically for calculating and plotting (*provided*).
- `./figures/`: figures generated from processed data (*provided*).

## Obtaining Raw Data

Raw NPP model-derived data products were obtained as `.nc` files from the repositories corresponding to the five models listed above. These files were then processed using scripts in in this related [repository](https://github.com/annarufas/ocean-data-lab) (not included here due to size constraints), resulting in the generation of the following five `.mat` files: `npp_vgpm_modis.mat`, `npp_cbpm_modis.mat`, `npp_cafe_modis.mat`, `npp_bicep.mat`, `npp_carr2002_seawifs_pathfinder_zeub97.mat` and `npp_carr2002_modis_pathfinder_zeuc02.mat`. Once generated, please place them under the `./data/raw/` directory.

## MATLAB Scripts

| Num| Script name                       | Script action                                                |
|----|-----------------------------------|---------------------------------------------------------------
| 1  | main.m                            | Main entry point for running the entire data processing and plotting pipeline  |
| 2  | calculateGloballyIntegratedNpp.m  | Calculation of globally integrated NPP stocks                |
| 3  | mapMonthlyNpp.m                   | Visualisation of monthly modelled NPP                        |
| 4  | mapAnnualNpp.m                    | Visualisation of annual modelled NPP                         |
| 5  | nppInsituMonthlyMean.m            | Processing of <sup>14</sup>C *in situ* observations and monthly values    |
| 6  | extractLocalModelledNpp.m         | Extraction of modelled NPP at study locations                |
| 7  | calculateMatchupStatistics.m      | Calculation of matchup statistics                            |
| 8  | plotBarChartInsituVsModelled.m    | Bar chart comparison of observations-models                  |

## Reproducibility

The provided scripts perform a matchup analysis using *in situ* data from the following time-series study sites:
- U.S. Joint Global Ocean Flux Study (JGOFS) Equatorial Pacific process study experimental site (EqPac), in the central equatorial Pacific upwelling system (0ºN, 140ºW).
- Hawaii Ocean Time-series (HOT) station ALOHA, in the subtropical NE Pacific (22.5ºN, 158ºW).
- Bermuda Atlantic Time-Series (BATS) study site, in the subtropical NW Atlantic (31.6ºN, 64.2ºW).
- Ocean Station Papa (OSP), in the high-nutrient, low-chlorophyll region of the subpolar NE Pacific (50ºN, 145ºW).

## Acknowledgments

This work was conducted as part of my ESA Living Planet Fellowship at the University of Oxford under the [SLAM DUNK](https://eo4society.esa.int/projects/slam-dunk/) project.

## Cite as

If you use this repository in your research, please cite it as:

> Rufas, A. (2024). annarufas/npp-product-comparison: Initial release (v1.0.0) [collection]. Zenodo. https://doi.org/10.5281/zenodo.14544975